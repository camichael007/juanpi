## 需求场景 ##
当一些项目经过测试环境和回归环境测试通过之后，就可以正式上线了。于是就需要在生产环境部署该项目，申请人会提供以下信息：
**项目代码仓库地址、新增域名、指向目录（默认是/data/htdocs/INDEX）**、所需资源数运维方需要根据评估业务量来分配资源，提高资源利用率。


![需求图片1](http://ocr4vlwzo.bkt.clouddn.com/%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E6%96%B0%E5%A2%9E%E5%9F%9F%E5%90%8D1.png)
![需求图片2](http://ocr4vlwzo.bkt.clouddn.com/%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E6%96%B0%E5%A2%9E%E5%9F%9F%E5%90%8D2.png)


## 结合需求展开：（以finance.juanpi.org为例） ##
到php-nginx服务器上的/usr/local/webserver/tengine/conf/vhosts目录下创建finance.juanpi.org.conf 虚拟主机配置文件，内容可以参考已有虚拟主机配置文件。

	>>cp default.juanpi.org.conf finance.juanpi.org.conf
	>>vim finance.juanpi.org.conf

![需求图片3](http://ocr4vlwzo.bkt.clouddn.com/%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E6%96%B0%E5%A2%9E%E5%9F%9F%E5%90%8D3.png)
在php-nginx服务器上，根据虚拟主机配置文件中的proxy_pass配置项，到/usr/local/webserver/tengine/conf/confs目录下创建upstream配置文件finance_upsteam.conf，添加后端php资源，最后重新加载nginx配置。

	>>cp admin_upsteam.conf finance_upsteam.conf
	>>vim finance_upsteam.conf


![需求图片4](http://ocr4vlwzo.bkt.clouddn.com/%E6%96%B0%E5%9F%9F%E5%90%8D-%E7%94%9F%E4%BA%A704.png)

到php机器上的/usr/local/webserver/tengine/conf/vhosts目录下创建finance.juanpi.org.conf 虚拟主机配置文件，根据申请指向特定目录，重新加载nginx配置。
	
	>>cp default.juanpi.org.conf finance.juanpi.org.conf
	>>vim finance.juanpi.org.conf

![需求图片5](http://ocr4vlwzo.bkt.clouddn.com/%E6%96%B0%E5%9F%9F%E5%90%8D-%E7%94%9F%E4%BA%A705.png)

在卷皮自动发布系统上配置新增的配置 finance代码发布到php机器指定目录下/data/htdocs/finance.juanpi.org

![需求图片6](http://ocr4vlwzo.bkt.clouddn.com/%E6%96%B0%E5%9F%9F%E5%90%8D-%E7%94%9F%E4%BA%A706.png)

![需求图片7](http://ocr4vlwzo.bkt.clouddn.com/%E6%96%B0%E5%9F%9F%E5%90%8D-%E7%94%9F%E4%BA%A707.png)

添加对应域名的解析在办公网DNS服务器的域名记录文件中添加，把域名和ip地址给到希行、马克即可。